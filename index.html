<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>TRADE ARMY | Ultimate Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Sƒ∞STEM AYARLARI */
        html, body { background: #0c0d10; margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; position: fixed; color: #d1d4dc; font-family: 'Inter', sans-serif; }
        * { -webkit-tap-highlight-color: transparent; touch-action: manipulation; }
        
        #chart-grid { display: grid; height: 100%; width: 100%; gap: 1px; background: #1e222d; }
        .grid-1 { grid-template-columns: 1fr; }
        .grid-2 { grid-template-columns: 1fr 1fr; }
        .grid-4 { grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; }

        /* PANELLER */
        .side-panel { width: 280px; background: #131722; border-left: 1px solid #1e222d; display: flex; flex-direction: column; transition: all 0.3s; }
        @media (max-width: 1024px) { .side-panel { display: none; } } /* Mobilde gizle */

        .control-btn { background: #1e222d; color: #81858e; border: 1px solid #2a2e39; padding: 5px 10px; border-radius: 4px; font-size: 11px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .active-layout { background: #2962ff !important; color: white !important; border-color: #2962ff; }

        /* RENK PANELƒ∞ POPUP */
        .color-popup { background: #1c202b; padding: 15px; border-radius: 12px; border: 1px solid #2962ff; position: absolute; top: 70px; right: 20px; z-index: 9999; display: none; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .color-popup.visible { display: block; }

        iframe { pointer-events: auto !important; touch-action: auto !important; }
    </style>
</head>
<body class="flex flex-col">

    <header class="h-16 border-b border-[#1e222d] bg-[#131722] flex items-center justify-between px-4 shrink-0 z-50">
        <div class="flex items-center space-x-4">
            <span class="text-blue-500 font-black italic text-xl tracking-tighter uppercase">Trade <span class="text-white">Army</span></span>
            <div class="flex space-x-1 bg-black/20 p-1 rounded">
                <button onclick="changeLayout(1, this)" class="control-btn active-layout">1</button>
                <button onclick="changeLayout(2, this)" class="control-btn">2</button>
                <button onclick="changeLayout(4, this)" class="control-btn">4</button>
            </div>
        </div>

        <div class="flex items-center space-x-3">
            <button onclick="toggleColorPanel()" class="control-btn border-blue-500/50">üé® Tema</button>
            <div id="active-symbol-text" class="text-[10px] font-mono text-gray-500 bg-black/40 px-2 py-1 rounded">BINANCE:BTCUSDT</div>
        </div>
    </header>

    <div id="colorPicker" class="color-popup w-64">
        <div class="text-[11px] font-bold text-blue-500 mb-4 uppercase tracking-widest border-b border-gray-700 pb-2">Grafik √ñzelle≈ütirme</div>
        <div class="space-y-4">
            <div class="flex justify-between items-center text-xs text-gray-300">
                <span>Y√ºkseli≈ü (Mum):</span>
                <input type="color" id="upColor" value="#089981" class="bg-transparent border-none w-8 h-8 cursor-pointer" onchange="saveAndApply()">
            </div>
            <div class="flex justify-between items-center text-xs text-gray-300">
                <span>D√º≈ü√º≈ü (Mum):</span>
                <input type="color" id="downColor" value="#f23645" class="bg-transparent border-none w-8 h-8 cursor-pointer" onchange="saveAndApply()">
            </div>
            <div class="flex justify-between items-center text-xs text-gray-300 border-t border-gray-700 pt-3">
                <span>Arka Plan:</span>
                <input type="color" id="bgColor" value="#131722" class="bg-transparent border-none w-8 h-8 cursor-pointer" onchange="saveAndApply()">
            </div>
        </div>
        <button onclick="toggleColorPanel()" class="w-full mt-5 bg-blue-600 hover:bg-blue-500 text-white font-bold text-[10px] py-2 rounded uppercase transition-all">Deƒüi≈üiklikleri Kaydet</button>
    </div>

    <div class="flex flex-1 overflow-hidden relative">
        
        <aside class="w-12 border-r border-[#1e222d] bg-[#0c0d10] flex flex-col items-center py-4 space-y-5 shrink-0">
            <button onclick="updateSymbol('BINANCE:BTCUSDT')" title="BTC" class="text-xl hover:scale-125 transition-transform">‚Çø</button>
            <button onclick="updateSymbol('BINANCE:ETHUSDT')" title="ETH" class="text-xl hover:scale-125 transition-transform">Œû</button>
            <button onclick="updateSymbol('TVC:GOLD')" title="ALTIN" class="text-xl hover:scale-125 transition-transform">üí∞</button>
            <button onclick="updateSymbol('FX:USDTRY')" title="DOLAR" class="text-xl hover:scale-125 transition-transform">‚Ç∫</button>
        </aside>

        <main class="flex-1 relative overflow-hidden bg-black">
            <div id="chart-grid" class="grid-1">
                <div id="tv_1" class="w-full h-full"></div>
                <div id="tv_2" class="w-full h-full hidden"></div>
                <div id="tv_3" class="w-full h-full hidden"></div>
                <div id="tv_4" class="w-full h-full hidden"></div>
            </div>
        </main>

        <aside class="side-panel shrink-0">
            <div class="h-1/2 border-b border-[#1e222d]">
                <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-technical-analysis.js" async>
                { "interval": "4h", "width": "100%", "isTransparent": true, "height": "100%", "symbol": "BINANCE:BTCUSDT", "showIntervalTabs": true, "locale": "tr", "colorTheme": "dark" }
                </script>
            </div>
            <div class="h-1/2">
                <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-events.js" async>
                { "colorTheme": "dark", "isTransparent": true, "width": "100%", "height": "100%", "locale": "tr", "importanceFilter": "-1,0,1", "currencyFilter": "USD,EUR,TRY" }
                </script>
            </div>
        </aside>
    </div>

    <nav class="h-14 border-t border-[#1e222d] bg-[#131722] flex shrink-0 lg:hidden">
        <button onclick="updateSymbol('BINANCE:BTCUSDT')" class="flex-1 text-[10px] font-bold">BTC</button>
        <button onclick="updateSymbol('BINANCE:ETHUSDT')" class="flex-1 text-[10px] font-bold border-l border-gray-800">ETH</button>
        <button onclick="updateSymbol('TVC:GOLD')" class="flex-1 text-[10px] font-bold border-l border-gray-800">ALTIN</button>
        <button onclick="updateSymbol('FX:USDTRY')" class="flex-1 text-[10px] font-bold border-l border-gray-800">DOLAR</button>
    </nav>

    <footer class="h-6 bg-black flex items-center justify-between px-4 text-[9px] text-gray-600 shrink-0">
        <div class="flex items-center space-x-2">
            <span class="text-blue-500 font-bold">TRADE ARMY v3.0</span>
            <span>¬© 2026</span>
        </div>
        <div class="text-green-500 font-bold tracking-widest">‚óè LIVE TERMINAL</div>
    </footer>

    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script>
        let currentSymbol = 'BINANCE:BTCUSDT';
        let currentCount = 1;

        // Hafƒ±zadan renkleri y√ºkle
        if(localStorage.getItem('upColor')) {
            document.getElementById('upColor').value = localStorage.getItem('upColor');
            document.getElementById('downColor').value = localStorage.getItem('downColor');
            document.getElementById('bgColor').value = localStorage.getItem('bgColor');
        }

        function toggleColorPanel() {
            document.getElementById('colorPicker').classList.toggle('visible');
        }

        function saveAndApply() {
            localStorage.setItem('upColor', document.getElementById('upColor').value);
            localStorage.setItem('downColor', document.getElementById('downColor').value);
            localStorage.setItem('bgColor', document.getElementById('bgColor').value);
            applyColors();
        }

        function initChart(id, symbol) {
            const up = document.getElementById('upColor').value;
            const down = document.getElementById('downColor').value;
            const bg = document.getElementById('bgColor').value;

            new TradingView.widget({
                "autosize": true, "symbol": symbol, "interval": "240", "theme": "dark", "style": "1", "locale": "tr",
                "toolbar_bg": bg, "enable_publishing": false, "hide_side_toolbar": false, "container_id": id,
                "withdateranges": true,
                "enabled_features": ["header_resolutions", "header_indicators", "header_settings", "header_symbol_search", "side_toolbar_in_fullscreen_mode", "header_chart_type"],
                "overrides": {
                    "paneProperties.background": bg,
                    "mainSeriesProperties.candleStyle.upColor": up,
                    "mainSeriesProperties.candleStyle.downColor": down,
                    "mainSeriesProperties.candleStyle.borderUpColor": up,
                    "mainSeriesProperties.candleStyle.borderDownColor": down,
                    "mainSeriesProperties.candleStyle.wickUpColor": up,
                    "mainSeriesProperties.candleStyle.wickDownColor": down
                }
            });
        }

        function applyColors() {
            for (let i = 1; i <= currentCount; i++) initChart(`tv_${i}`, currentSymbol);
        }

        function changeLayout(count, btn) {
            currentCount = count;
            document.getElementById('chart-grid').className = `grid-${count}`;
            document.querySelectorAll('.control-btn').forEach(b => b.classList.remove('active-layout'));
            if(btn) btn.classList.add('active-layout');
            for (let i = 1; i <= 4; i++) {
                const el = document.getElementById(`tv_${i}`);
                if (i <= count) { el.classList.remove('hidden'); initChart(`tv_${i}`, currentSymbol); }
                else { el.classList.add('hidden'); el.innerHTML = ""; }
            }
        }

        function updateSymbol(s) {
            currentSymbol = s;
            document.getElementById('active-symbol-text').innerText = s;
            for (let i = 1; i <= currentCount; i++) initChart(`tv_${i}`, s);
        }

        window.onload = () => initChart('tv_1', currentSymbol);
    </script>
</body>
</html>
